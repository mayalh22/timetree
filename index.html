<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Time Tree</title>
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
  rel="stylesheet"
>
<style>
:root {
  --color-bg-dark: hsl(88, 83%, 80%);
  --color-text-light: #94e06a;
  --color-green-accent: #efbac0;
  --color-green-subtle: #17a623;
  --font-pixel: 'Press Start 2P', monospace;
}

.display-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2rem;
}


  body {
    background: var(--color-bg-dark);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    margin: 0;
    font-family: var(--font-pixel);
    color: var(--color-text-light);
    padding: 1rem;
    box-sizing: border-box;
  }

  h1 {
    font-size: 2rem;
    text-shadow: 2px 2px var(--color-green-accent);
    margin-bottom: 2rem;
  }

  .controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  input,
  button {
    font-size: 0.8rem;
    font-family: var(--font-pixel);
    background-color: var(--color-green-accent);
    color: var(--color-text-light);
    border: 2px solid var(--color-green-subtle);
    padding: 0.6rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    text-transform: uppercase;
    transition: background-color 0.2s, border-color 0.2s;
    outline: none;
  }

  input {
    text-align: center;
    max-width: 150px;
    background-color: transparent;
  }

  input::placeholder {
    color: var(--color-green-subtle);
    opacity: 0.8;
  }

  input:focus,
  button:hover,
  button:focus {
    background-color: var(--color-green-subtle);
    border-color: var(--color-text-light);
    color: var(--color-bg-dark);
  }

  button:disabled {
    cursor: not-allowed;
    opacity: 0.6;
  }

  canvas {
    image-rendering: pixelated;
    background: var(--color-green-accent);
    margin-top: 1rem;
    border: 2px solid var(--color-green-subtle);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
  }

  .music-tooltip {
    font-size: 0.6rem;
    color: var(--color-green-subtle);
    margin-top: 0.5rem;
  }
</style>
</head>
<body>
  <h1>Time Tree</h1>
  <div class="display-container">
  <canvas id="timerCanvas" width="300" height="200"></canvas>
  <canvas id="treeCanvas" width="100" height="200"></canvas>
</div>

  <div class="controls">
    <input
      id="inputSeconds"
      type="number"
      min="1"
      placeholder="Time in seconds"
      aria-label="Enter time in seconds"
    />
    <div>
      <button id="startPauseBtn" aria-label="Start or Pause Timer">Start</button>
      <button id="resetBtn" aria-label="Reset Timer">Reset</button>
    </div>
  </div>

  <button id="musicBtn" aria-label="Toggle background music">Play Music</button>
  <audio id="bgMusic" loop>
    <source
      src="https://cdn.pixabay.com/download/audio/2022/03/03/audio_2d59e2f48f.mp3?filename=relaxing-music-ambient-3781.mp3"
      type="audio/mpeg"
    />
  </audio>

  <canvas id="timerCanvas" width="600" height="200"></canvas>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const canvas = document.getElementById('timerCanvas');
      const ctx = canvas.getContext('2d');
      const startPauseBtn = document.getElementById('startPauseBtn');
      const resetBtn = document.getElementById('resetBtn');
      const musicBtn = document.getElementById('musicBtn');
      const input = document.getElementById('inputSeconds');
      const bgMusic = document.getElementById('bgMusic');
const timerCanvas = document.getElementById('timerCanvas');
const timerCtx = timerCanvas.getContext('2d');

const treeCanvas = document.getElementById('treeCanvas');
const treeCtx = treeCanvas.getContext('2d');

      const PIXEL_SIZE = 15;
      const FONT_COLOR = '#e0f8cf';
      const DIGIT_WIDTH = 5;
      const DIGIT_HEIGHT = 7;
      const DIGIT_SPACING = 2;
      
      let countdownInterval;
      let isRunning = false;
      let timeLeft = 0;
      let totalSeconds;
      let maxTreeHeight = canvas.height - 40;
      let treeHeight = 0;

      const digits = {
        '0': [
          [0,1,1,1,0],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [0,1,1,1,0]
        ],
        '1': [
          [0,0,1,0,0],
          [0,1,1,0,0],
          [0,0,1,0,0],
          [0,0,1,0,0],
          [0,0,1,0,0],
          [0,0,1,0,0],
          [1,1,1,1,1]
        ],
        '2': [
          [1,1,1,1,1],
          [0,0,0,0,1],
          [0,0,0,1,0],
          [0,0,1,0,0],
          [0,1,0,0,0],
          [1,0,0,0,0],
          [1,1,1,1,1]
        ],
        '3': [
          [1,1,1,1,1],
          [0,0,0,0,1],
          [0,0,1,1,1],
          [0,0,0,0,1],
          [0,0,0,0,1],
          [0,0,0,0,1],
          [1,1,1,1,1]
        ],
        '4': [
          [1,0,0,0,1],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [1,1,1,1,1],
          [0,0,0,0,1],
          [0,0,0,0,1],
          [0,0,0,0,1]
        ],
        '5': [
          [1,1,1,1,1],
          [1,0,0,0,0],
          [1,1,1,1,0],
          [0,0,0,0,1],
          [0,0,0,0,1],
          [1,0,0,0,1],
          [0,1,1,1,0]
        ],
        '6': [
          [0,1,1,1,0],
          [1,0,0,0,0],
          [1,0,0,0,0],
          [1,1,1,1,0],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [0,1,1,1,0]
        ],
        '7': [
          [1,1,1,1,1],
          [0,0,0,0,1],
          [0,0,0,1,0],
          [0,0,1,0,0],
          [0,1,0,0,0],
          [0,1,0,0,0],
          [0,1,0,0,0]
        ],
        '8': [
          [0,1,1,1,0],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [0,1,1,1,0],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [0,1,1,1,0]
        ],
        '9': [
          [0,1,1,1,0],
          [1,0,0,0,1],
          [1,0,0,0,1],
          [0,1,1,1,1],
          [0,0,0,0,1],
          [0,0,0,0,1],
          [0,1,1,1,0]
        ],
        ':': [
          [0,0],
          [0,1],
          [0,0],
          [0,0],
          [0,1],
          [0,0],
          [0,0]
        ]
      };

function drawDigit(ctx, digit, x, y) {
  const pattern = digits[digit];
  if (!pattern) return;

  ctx.fillStyle = FONT_COLOR;
  for (let row = 0; row < pattern.length; row++) {
    for (let col = 0; col < pattern[row].length; col++) {
      if (pattern[row][col] === 1) {
        ctx.fillRect(
          x + col * PIXEL_SIZE,
          y + row * PIXEL_SIZE,
          PIXEL_SIZE,
          PIXEL_SIZE
        );
      }
    }
  }
}


      function formatTime(ms) {
        const minutes = Math.floor(ms / 60000);
        const seconds = Math.floor((ms % 60000) / 1000);
        const milliseconds = Math.floor((ms % 1000) / 10);
        
        const mStr = String(minutes).padStart(2, '0');
        const sStr = String(seconds).padStart(2, '0');
        const msStr = String(milliseconds).padStart(2, '0');

        return `${mStr}:${sStr}:${msStr}`;
      }

function drawTime(timeString) {
  timerCtx.clearRect(0, 0, timerCanvas.width, timerCanvas.height);

  let totalWidth = 0;
  for (const char of timeString) {
    totalWidth += (char === ':' ? PIXEL_SIZE : DIGIT_WIDTH * PIXEL_SIZE) + PIXEL_SIZE;
  }
  totalWidth -= PIXEL_SIZE;

  let startX = (timerCanvas.width - totalWidth) / 2;
  const startY = (timerCanvas.height - DIGIT_HEIGHT * PIXEL_SIZE) / 2;

  for (const char of timeString) {
    drawDigit(timerCtx, char, startX, startY);
    startX += (char === ':' ? PIXEL_SIZE : DIGIT_WIDTH * PIXEL_SIZE) + PIXEL_SIZE;
  }
}
function drawTree() {
  const trunkWidth = 10;
  const padding = 10;
  const trunkX = treeCanvas.width / 2 - trunkWidth / 2;
  const trunkY = treeCanvas.height;

  treeCtx.clearRect(0, 0, treeCanvas.width, treeCanvas.height);

  // Trunk
  treeCtx.fillStyle = '#7b3f00';
  treeCtx.fillRect(trunkX, trunkY - treeHeight, trunkWidth, treeHeight);

  // Leaves
  const leafRadius = Math.min(30, treeHeight / 4);
  treeCtx.beginPath();
  treeCtx.arc(trunkX + trunkWidth / 2, trunkY - treeHeight, leafRadius, 0, 2 * Math.PI);
  treeCtx.fillStyle = '#228B22';
  treeCtx.fill();
}
      
function startTimer() {
  if (isRunning) return;

  let secondsInput = parseInt(input.value, 10);
  if (isNaN(secondsInput) || secondsInput <= 0) {
    input.value = '';
    input.placeholder = 'Please enter a number';
    return;
  }

  totalSeconds = secondsInput;
  timeLeft = totalSeconds * 1000;
  isRunning = true;
  startPauseBtn.textContent = 'Pause';
  input.disabled = true;

  const startTime = Date.now();

  countdownInterval = setInterval(() => {
    const elapsedTime = Date.now() - startTime;
    const remainingTime = timeLeft - elapsedTime;

    if (remainingTime <= 0) {
      clearInterval(countdownInterval);
      isRunning = false;
      startPauseBtn.textContent = 'Start';
      input.disabled = false;
      treeHeight = maxTreeHeight;
      drawTime('00:00:00');
      bgMusic.pause();
      musicBtn.textContent = 'Play Music';
      return;
    }

    const growthRatio = Math.min(1, elapsedTime / (totalSeconds * 1000));
    treeHeight = growthRatio * maxTreeHeight;

    drawTime(formatTime(remainingTime));
  }, 10);
}      function pauseTimer() {
        clearInterval(countdownInterval);
        isRunning = false;
        startPauseBtn.textContent = 'Resume';
      }

      function resetTimer() {
        clearInterval(countdownInterval);
        isRunning = false;
        startPauseBtn.textContent = 'Start';
        input.disabled = false;
        input.value = '';
        treeHeight = 0;
        drawTime('00:00:00');
        bgMusic.pause();
        musicBtn.textContent = 'Play Music';
      }

      startPauseBtn.addEventListener('click', () => {
        if (isRunning) {
          pauseTimer();
        } else {
          startTimer();
        }
      });

      resetBtn.addEventListener('click', resetTimer);

      musicBtn.addEventListener('click', () => {
        if (bgMusic.paused) {
          bgMusic.play();
          musicBtn.textContent = 'Pause Music';
        } else {
          bgMusic.pause();
          musicBtn.textContent = 'Play Music';
        }
      });

      treeHeight = 0;
      drawTime('00:00:00');

    });
  </script>
</body>
</html>
